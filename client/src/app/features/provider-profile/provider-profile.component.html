<div class="provider-profile-container">
  <!-- Header del Perfil -->
  <div class="profile-header">
    <h1>ğŸ¢ Mi Perfil Empresarial</h1>
    <p>Gestiona la informaciÃ³n de tu empresa y servicios</p>
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Cargando tu perfil...</p>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage && !isLoading" class="error-message">
    <div class="error-icon">âŒ</div>
    <h3>Error</h3>
    <p>{{ errorMessage }}</p>
    <button (click)="loadProfile()" class="btn-retry">ğŸ”„ Reintentar</button>
  </div>

  <!-- Perfil Cargado -->
  <div *ngIf="profile && !isLoading && !errorMessage" class="profile-content">
    
    <!-- EstadÃ­sticas del Perfil -->
    <div class="profile-stats">
      <div class="stat-card">
        <div class="stat-icon">ğŸ“Š</div>
        <div class="stat-info">
          <h3>{{ getCompletionPercentage() }}%</h3>
          <p>Perfil Completado</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">â­</div>
        <div class="stat-info">
          <h3>{{ profile.rating.toFixed(1) }}</h3>
          <p>CalificaciÃ³n ({{ profile.reviewCount }} reseÃ±as)</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">ğŸ› ï¸</div>
        <div class="stat-info">
          <h3>{{ profile._count.services }}</h3>
          <p>Servicios Activos</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">ğŸ“…</div>
        <div class="stat-info">
          <h3>{{ profile._count.bookings }}</h3>
          <p>Reservas Totales</p>
        </div>
      </div>
    </div>

    <!-- InformaciÃ³n BÃ¡sica (No Editable) -->
    <div class="info-section">
      <div class="section-header">
        <h3>ğŸ‘¤ InformaciÃ³n Personal</h3>
      </div>
      
      <div class="info-grid">
        <div class="info-item">
          <label>ğŸ“§ Email:</label>
          <span>{{ profile.user.email }}</span>
        </div>
        
        <div class="info-item">
          <label>ğŸ‘¤ Nombre:</label>
          <span>{{ profile.user.name }}</span>
        </div>
        
        <div class="info-item">
          <label>ğŸ“± TelÃ©fono Personal:</label>
          <span>{{ profile.user.phone || 'No registrado' }}</span>
        </div>
        
        <div class="info-item">
          <label>ğŸ“… Miembro desde:</label>
          <span>{{ profile.createdAt | date:'mediumDate' }}</span>
        </div>
      </div>
    </div>

    <!-- InformaciÃ³n Empresarial (Editable) -->
    <div class="company-section">
      <div class="section-header">
        <h3>ğŸ¢ InformaciÃ³n Empresarial</h3>
        <button 
          class="btn-edit"
          (click)="toggleEdit()"
          [class.editing]="isEditing">
          {{ isEditing ? 'âŒ Cancelar' : 'âœï¸ Editar' }}
        </button>
      </div>

      <!-- Modo VisualizaciÃ³n -->
      <div *ngIf="!isEditing" class="company-display">
        <div class="company-grid">
          <div class="company-item">
            <label>ğŸ¢ Nombre de la Empresa:</label>
            <span>{{ profile.companyName || 'No registrado' }}</span>
          </div>
          
          <div class="company-item">
            <label>ğŸ†” NIT:</label>
            <span>{{ profile.nit || 'No registrado' }}</span>
          </div>
          
          <div class="company-item">
            <label>ğŸ“ DirecciÃ³n:</label>
            <span>{{ profile.address || 'No registrada' }}</span>
          </div>
          
          <div class="company-item">
            <label>ğŸ™ï¸ Ciudad:</label>
            <span>{{ profile.city || 'No registrada' }}</span>
          </div>
          
          <div class="company-item">
            <label>ğŸ“ TelÃ©fono Empresarial:</label>
            <span>{{ profile.phone || 'No registrado' }}</span>
          </div>
          
          <div class="company-item">
            <label>ğŸŒ Sitio Web:</label>
            <span>
              <a *ngIf="profile.website" [href]="profile.website" target="_blank" class="website-link">
                {{ profile.website }}
              </a>
              <span *ngIf="!profile.website">No registrado</span>
            </span>
          </div>
        </div>
        
        <div class="company-description">
          <label>ğŸ“ DescripciÃ³n de la Empresa:</label>
          <p>{{ profile.description || 'No hay descripciÃ³n disponible' }}</p>
        </div>
      </div>

      <!-- Modo EdiciÃ³n -->
      <div *ngIf="isEditing" class="company-form">
        <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
          <div class="form-row">
            <div class="form-group">
              <label for="companyName">ğŸ¢ Nombre de la Empresa</label>
              <input 
                type="text" 
                id="companyName"
                formControlName="companyName"
                placeholder="Ej: TechSolutions SAS"
                class="form-input"
                [class.error]="profileForm.get('companyName')?.invalid && profileForm.get('companyName')?.touched">
              
              <div class="error-text" *ngIf="profileForm.get('companyName')?.invalid && profileForm.get('companyName')?.touched">
                <span *ngIf="profileForm.get('companyName')?.errors?.['minlength']">MÃ­nimo 2 caracteres</span>
              </div>
            </div>

            <div class="form-group">
              <label for="nit">ğŸ†” NIT</label>
              <input 
                type="text" 
                id="nit"
                formControlName="nit"
                placeholder="Ej: 900123456-1"
                class="form-input"
                [class.error]="profileForm.get('nit')?.invalid && profileForm.get('nit')?.touched">
              
              <div class="error-text" *ngIf="profileForm.get('nit')?.invalid && profileForm.get('nit')?.touched">
                <span *ngIf="profileForm.get('nit')?.errors?.['pattern']">Formato: 123456789-1</span>
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="address">ğŸ“ DirecciÃ³n</label>
              <input 
                type="text" 
                id="address"
                formControlName="address"
                placeholder="Ej: Carrera 50 #30-25"
                class="form-input">
            </div>

            <div class="form-group">
              <label for="city">ğŸ™ï¸ Ciudad</label>
              <input 
                type="text" 
                id="city"
                formControlName="city"
                placeholder="Ej: MedellÃ­n"
                class="form-input">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="phone">ğŸ“ TelÃ©fono Empresarial</label>
              <input 
                type="text" 
                id="phone"
                formControlName="phone"
                placeholder="Ej: +57 300 123 4567"
                class="form-input"
                [class.error]="profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched">
              
              <div class="error-text" *ngIf="profileForm.get('phone')?.invalid && profileForm.get('phone')?.touched">
                <span *ngIf="profileForm.get('phone')?.errors?.['pattern']">Formato de telÃ©fono invÃ¡lido</span>
              </div>
            </div>

            <div class="form-group">
              <label for="website">ğŸŒ Sitio Web</label>
              <input 
                type="text" 
                id="website"
                formControlName="website"
                placeholder="Ej: https://miempresa.com"
                class="form-input"
                [class.error]="profileForm.get('website')?.invalid && profileForm.get('website')?.touched">
              
              <div class="error-text" *ngIf="profileForm.get('website')?.invalid && profileForm.get('website')?.touched">
                <span *ngIf="profileForm.get('website')?.errors?.['pattern']">Debe empezar con http:// o https://</span>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="description">ğŸ“ DescripciÃ³n de la Empresa</label>
            <textarea 
              id="description"
              formControlName="description"
              placeholder="Describe tu empresa, servicios y experiencia..."
              rows="5"
              class="form-textarea"
              [class.error]="profileForm.get('description')?.invalid && profileForm.get('description')?.touched">
            </textarea>
            
            <div class="char-counter">
              {{ profileForm.get('description')?.value?.length || 0 }}/500 caracteres
            </div>
            
            <div class="error-text" *ngIf="profileForm.get('description')?.invalid && profileForm.get('description')?.touched">
              <span *ngIf="profileForm.get('description')?.errors?.['maxlength']">MÃ¡ximo 500 caracteres</span>
            </div>
          </div>

          <div class="form-actions">
            <button 
              type="button" 
              class="btn-cancel"
              (click)="toggleEdit()">
              âŒ Cancelar
            </button>
            
            <button 
              type="submit" 
              class="btn-save"
              [disabled]="profileForm.invalid || isSaving">
              <span *ngIf="!isSaving">ğŸ’¾ Guardar Cambios</span>
              <span *ngIf="isSaving">â³ Guardando...</span>
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Enlaces RÃ¡pidos -->
    <div class="quick-actions">
      <h3>âš¡ Acciones RÃ¡pidas</h3>
      <div class="actions-grid">
        <a routerLink="/my-services" class="action-card">
          <div class="action-icon">ğŸ› ï¸</div>
          <div class="action-info">
            <h4>Gestionar Servicios</h4>
            <p>Crear, editar y administrar tus servicios</p>
          </div>
        </a>
        
        <a routerLink="/marketplace" class="action-card">
          <div class="action-icon">ğŸª</div>
          <div class="action-info">
            <h4>Ver Marketplace</h4>
            <p>Explora cÃ³mo ven los clientes tus servicios</p>
          </div>
        </a>
        
        <a routerLink="/dashboard" class="action-card">
          <div class="action-icon">ğŸ“Š</div>
          <div class="action-info">
            <h4>Dashboard</h4>
            <p>EstadÃ­sticas y mÃ©tricas de tu negocio</p>
          </div>
        </a>
      </div>
    </div>
  </div>
</div>